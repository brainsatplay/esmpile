(()=>{var Ze=Object.create;var ue=Object.defineProperty;var et=Object.getOwnPropertyDescriptor;var tt=Object.getOwnPropertyNames;var rt=Object.getPrototypeOf,nt=Object.prototype.hasOwnProperty;var ot=(e=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(e,{get:(t,r)=>(typeof require!="undefined"?require:t)[r]}):e)(function(e){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var at=(e,t)=>()=>(e&&(t=e(e=0)),t);var st=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),P=(e,t)=>{for(var r in t)ue(e,r,{get:t[r],enumerable:!0})},it=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of tt(t))!nt.call(e,n)&&n!==r&&ue(e,n,{get:()=>t[n],enumerable:!(o=et(t,n))||o.enumerable});return e};var Re=(e,t,r)=>(r=e!=null?Ze(rt(e)):{},it(t||!e||!e.__esModule?ue(r,"default",{value:e,enumerable:!0}):r,e));var Se=st(te=>{(function(e){(function(t){typeof define=="function"&&define.amd?define(["exports"],t):typeof te=="object"&&typeof te.nodeName!="string"?t(te):t(e)})(function(t){"use strict";var r=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder,o=e.URL||e.webkitURL||function(p,i){return i=document.createElement("a"),i.href=p,i},n=e.Blob,s=o.createObjectURL,l=o.revokeObjectURL,f=e.Symbol&&e.Symbol.toStringTag,d=!1,B=!1,E=r&&r.prototype.append&&r.prototype.getBlob;try{d=new Blob(["\xE4"]).size===2,B=new Blob([new Uint8Array([1,2])]).size===2}catch{}function c(p){return p.map(function(i){if(i.buffer instanceof ArrayBuffer){var h=i.buffer;if(i.byteLength!==h.byteLength){var m=new Uint8Array(i.byteLength);m.set(new Uint8Array(h,i.byteOffset,i.byteLength)),h=m.buffer}return h}return i})}function R(p,i){i=i||{};var h=new r;return c(p).forEach(function(m){h.append(m)}),i.type?h.getBlob(i.type):h.getBlob()}function j(p,i){return new n(c(p),i||{})}e.Blob&&(R.prototype=Blob.prototype,j.prototype=Blob.prototype);function W(p){for(var i=0,h=p.length,m=e.Uint8Array||Array,b=0,w=Math.max(32,h+(h>>1)+7),x=new m(w>>3<<3);i<h;){var u=p.charCodeAt(i++);if(u>=55296&&u<=56319){if(i<h){var M=p.charCodeAt(i);(M&64512)===56320&&(++i,u=((u&1023)<<10)+(M&1023)+65536)}if(u>=55296&&u<=56319)continue}if(b+4>x.length){w+=8,w*=1+i/p.length*2,w=w>>3<<3;var q=new Uint8Array(w);q.set(x),x=q}if((u&4294967168)===0){x[b++]=u;continue}else if((u&4294965248)===0)x[b++]=u>>6&31|192;else if((u&4294901760)===0)x[b++]=u>>12&15|224,x[b++]=u>>6&63|128;else if((u&4292870144)===0)x[b++]=u>>18&7|240,x[b++]=u>>12&63|128,x[b++]=u>>6&63|128;else continue;x[b++]=u&63|128}return x.slice(0,b)}function _(p){for(var i=p.length,h=[],m=0;m<i;){var b=p[m],w=null,x=b>239?4:b>223?3:b>191?2:1;if(m+x<=i){var u,M,q,v;switch(x){case 1:b<128&&(w=b);break;case 2:u=p[m+1],(u&192)===128&&(v=(b&31)<<6|u&63,v>127&&(w=v));break;case 3:u=p[m+1],M=p[m+2],(u&192)===128&&(M&192)===128&&(v=(b&15)<<12|(u&63)<<6|M&63,v>2047&&(v<55296||v>57343)&&(w=v));break;case 4:u=p[m+1],M=p[m+2],q=p[m+3],(u&192)===128&&(M&192)===128&&(q&192)===128&&(v=(b&15)<<18|(u&63)<<12|(M&63)<<6|q&63,v>65535&&v<1114112&&(w=v))}}w===null?(w=65533,x=1):w>65535&&(w-=65536,h.push(w>>>10&1023|55296),w=56320|w&1023),h.push(w),m+=x}for(var N=h.length,F="",z=0;z<N;)F+=String.fromCharCode.apply(String,h.slice(z,z+=4096));return F}var L=typeof TextEncoder=="function"?TextEncoder.prototype.encode.bind(new TextEncoder):W,D=typeof TextDecoder=="function"?TextDecoder.prototype.decode.bind(new TextDecoder):_;function k(){function p(a){for(var y=new Array(a.byteLength),g=new Uint8Array(a),U=y.length;U--;)y[U]=g[U];return y}function i(a){for(var y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",g=[],U=0;U<a.length;U+=3){var A=a[U],V=U+1<a.length,G=V?a[U+1]:0,Ue=U+2<a.length,Ee=Ue?a[U+2]:0,We=A>>2,Qe=(A&3)<<4|G>>4,Fe=(G&15)<<2|Ee>>6,Te=Ee&63;Ue||(Te=64,V||(Fe=64)),g.push(y[We],y[Qe],y[Fe],y[Te])}return g.join("")}var h=Object.create||function(a){function y(){}return y.prototype=a,new y};function m(a){return Object.prototype.toString.call(a).slice(8,-1)}function b(a,y){return typeof a=="object"&&Object.prototype.isPrototypeOf.call(a.prototype,y)}function w(a){return m(a)==="DataView"||b(e.DataView,a)}var x=["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","ArrayBuffer"];function u(a,y){return a.indexOf(y)!==-1}function M(a){return u(x,m(a))||b(e.ArrayBuffer,a)}function q(a){for(var y=0,g=a.length;g--;)y+=a[g].length;for(var U=new Uint8Array(y),A=0,V=0;V<a.length;V++){var G=a[V];U.set(G,A),A+=G.byteLength||G.length}return U}function v(a,y){a=a||[],y=y??{};for(var g=0,U=a.length;g<U;g++){var A=a[g];A instanceof v?a[g]=A._buffer:typeof A=="string"?a[g]=L(A):w(A)?a[g]=p(A.buffer):M(A)?a[g]=p(A):a[g]=L(String(A))}this._buffer=e.Uint8Array?q(a):[].concat.apply([],a),this.size=this._buffer.length,this.type=y.type||"",/[^\u0020-\u007E]/.test(this.type)?this.type="":this.type=this.type.toLowerCase()}v.prototype.arrayBuffer=function(){return Promise.resolve(this._buffer.buffer||this._buffer)},v.prototype.text=function(){return Promise.resolve(D(this._buffer))},v.prototype.slice=function(a,y,g){var U=this._buffer.slice(a||0,y||this._buffer.length);return new v([U],{type:g})},v.prototype.toString=function(){return"[object Blob]"};function N(a,y,g){g=g||{};var U=v.call(this,a,g)||this;return U.name=y.replace(/\//g,":"),U.lastModifiedDate=g.lastModified?new Date(g.lastModified):new Date,U.lastModified=+U.lastModifiedDate,U}if(N.prototype=h(v.prototype),N.prototype.constructor=N,Object.setPrototypeOf)Object.setPrototypeOf(N,v);else try{N.__proto__=v}catch{}N.prototype.toString=function(){return"[object File]"};function F(){if(!(this instanceof F))throw new TypeError("Failed to construct 'FileReader': Please use the 'new' operator, this DOM object constructor cannot be called as a function.");var a=document.createDocumentFragment();this.addEventListener=a.addEventListener,this.dispatchEvent=function(y){var g=this["on"+y.type];typeof g=="function"&&g(y),a.dispatchEvent(y)},this.removeEventListener=a.removeEventListener}function z(a,y,g){if(!(y instanceof v))throw new TypeError("Failed to execute '"+g+"' on 'FileReader': parameter 1 is not of type 'Blob'.");a.result="",setTimeout(function(){this.readyState=F.LOADING,a.dispatchEvent(new Event("load")),a.dispatchEvent(new Event("loadend"))})}F.EMPTY=0,F.LOADING=1,F.DONE=2,F.prototype.error=null,F.prototype.onabort=null,F.prototype.onerror=null,F.prototype.onload=null,F.prototype.onloadend=null,F.prototype.onloadstart=null,F.prototype.onprogress=null,F.prototype.readAsDataURL=function(a){z(this,a,"readAsDataURL"),this.result="data:"+a.type+";base64,"+i(a._buffer)},F.prototype.readAsText=function(a){z(this,a,"readAsText"),this.result=D(a._buffer)},F.prototype.readAsArrayBuffer=function(a){z(this,a,"readAsText"),this.result=(a._buffer.buffer||a._buffer).slice()},F.prototype.abort=function(){},o.createObjectURL=function(a){return a instanceof v?"data:"+a.type+";base64,"+i(a._buffer):s.call(o,a)},o.revokeObjectURL=function(a){l&&l.call(o,a)};var fe=e.XMLHttpRequest&&e.XMLHttpRequest.prototype.send;fe&&(XMLHttpRequest.prototype.send=function(a){a instanceof v?(this.setRequestHeader("Content-Type",a.type),fe.call(this,D(a._buffer))):fe.call(this,a)}),t.Blob=v,t.File=N,t.FileReader=F,t.URL=o}function J(){var p=!!e.ActiveXObject||"-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style,i=e.XMLHttpRequest&&e.XMLHttpRequest.prototype.send;p&&i&&(XMLHttpRequest.prototype.send=function(h){h instanceof Blob?(this.setRequestHeader("Content-Type",h.type),i.call(this,h)):i.call(this,h)});try{new File([],""),t.File=e.File,t.FileReader=e.FileReader}catch{try{t.File=new Function('class File extends Blob {constructor(chunks, name, opts) {opts = opts || {};super(chunks, opts || {});this.name = name.replace(/\\//g, ":");this.lastModifiedDate = opts.lastModified ? new Date(opts.lastModified) : new Date();this.lastModified = +this.lastModifiedDate;}};return new File([], ""), File')()}catch{t.File=function(b,w,x){var u=new Blob(b,x),M=x&&x.lastModified!==void 0?new Date(x.lastModified):new Date;return u.name=w.replace(/\//g,":"),u.lastModifiedDate=M,u.lastModified=+M,u.toString=function(){return"[object File]"},f&&(u[f]="File"),u}}}}d?(J(),t.Blob=B?e.Blob:j):E?(J(),t.Blob=R):k(),f&&(t.File.prototype[f]||(t.File.prototype[f]="File"),t.Blob.prototype[f]||(t.Blob.prototype[f]="Blob"),t.FileReader.prototype[f]||(t.FileReader.prototype[f]="FileReader"));var I=t.Blob.prototype,C;try{new ReadableStream({type:"bytes"}),C=function(){var i=0,h=this;return new ReadableStream({type:"bytes",autoAllocateChunkSize:524288,pull:function(m){var b=m.byobRequest.view,w=h.slice(i,i+b.byteLength);return w.arrayBuffer().then(function(x){var u=new Uint8Array(x),M=u.byteLength;i+=M,b.set(u),m.byobRequest.respond(M),i>=h.size&&m.close()})}})}}catch{try{new ReadableStream({}),C=function(h){var m=0;return new ReadableStream({pull:function(b){var w=h.slice(m,m+524288);return w.arrayBuffer().then(function(x){m+=x.byteLength;var u=new Uint8Array(x);b.enqueue(u),m==h.size&&b.close()})}})}}catch{try{new Response("").body.getReader().read(),C=function(){return new Response(this).body}}catch{C=function(){throw new Error("Include https://github.com/MattiasBuelens/web-streams-polyfill")}}}}function ve(p){return new Promise(function(i,h){p.onload=p.onerror=function(m){p.onload=p.onerror=null,m.type==="load"?i(p.result||p):h(new Error("Failed to read the blob/file"))}})}I.arrayBuffer||(I.arrayBuffer=function(){var i=new FileReader;return i.readAsArrayBuffer(this),ve(i)}),I.text||(I.text=function(){var i=new FileReader;return i.readAsText(this),ve(i)}),I.stream||(I.stream=C)})})(typeof self<"u"&&self||typeof window<"u"&&window||typeof global<"u"&&global||te)});var $e={};P($e,{default:()=>ut});var Oe,ut,_e=at(()=>{Oe=Re(Se(),1),ut=Oe.Blob});var O={};P(O,{absolute:()=>H,base:()=>Ae,extension:()=>S,get:()=>T,noBase:()=>$,url:()=>Z});var Q="application/javascript",Me=e=>!e||e==="application/javascript",de={js:Q,mjs:Q,cjs:Q,ts:"text/typescript",json:"application/json",html:"text/html",css:"text/css",txt:"text/plain",svg:"image/svg+xml",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",webp:"image/webp",mp3:"audio/mpeg",mp4:"video/mp4",webm:"video/webm",ogg:"application/ogg",wav:"audio/wav"},re=e=>de[e];var he={};P(he,{defaults:()=>Y,getMainPath:()=>Le,path:()=>ne,resolve:()=>Be,transformation:()=>X});var Y={nodeModules:"node_modules",relativeTo:"./"},ne=e=>{let t=e.nodeModules??Y.nodeModules,r=e.relativeTo??Y.relativeTo;return T(t,r)},Be=async(e,t)=>{let r=ne(t),o=e.split("/"),n=T(e,r);if(o.length>1){if(S(n))return n;n+="/package.json"}return await Le(e,n,t).catch(s=>{console.warn(`${n} does not exist or is not at the root of the project.`)})},je=(e,t,r)=>T(e,r,!1,t.split("/").length===1),lt=(e,t=e)=>je("package.json",e,t),Le=async(e,t=e,r={})=>{let o=await ct(e,t,r);if(!o)return t;let n=o.module||o.main||"index.js";return je(n,e,t)},ct=async(e,t=e,r)=>{let o=lt(e,t);return(await import(Z(o)?o:new URL(o,window.location.href).href,{assert:{type:"json"}})).default},X={name:"node_modules",handler:Be};var ee="://",T=(e,t="",r=!1,o=!1)=>{if(Z(e))return e;let n="",s=c=>(n=c.includes(ee)?c.split(ee).splice(0,1):void 0,n?c.replace(`${n}${ee}`,""):c);e.includes(ee)&&(e=s(e)),t.includes(ee)&&(t=s(t)),r||(t=t.split("/").filter(c=>c!="..").join("/")),t[t.length-1]==="/"&&(t=t.slice(0,-1));let l=t.split("/");if(l.length===1&&l[0]===""&&(l=[]),!o){let c=l.pop();if(c){let R=c.split(".");(R.length==1||R.length>1&&R.includes(""))&&l.push(c)}}let B=e.split("/").filter((c,R)=>!!c).filter((c,R)=>c===".."?(l.pop(),!1):c!=="."),E=[...l,...B].join("/");return n?n+"://"+E:E};function H(e,t){let r=e[0]!==".",o=Z(e);return r&&(t||!o)}function Z(e){try{return new URL(e),!0}catch{return!1}}var S=e=>{let t=e.split("/").slice(-1)[0].split(".").slice(-1)[0];if(de[t])return t},Ae=e=>e.substring(0,e.lastIndexOf("/")),$=(e,t,r)=>{let o=H(e,!0),n=t.relativeTo??Y.relativeTo,s=t.nodeModules??Y.nodeModules,l=globalThis.location?e.replace(`${Ae(globalThis.location.href)}/`,""):e;if(o)return l;{let f=l;return r&&(f=f.replace(`${s}/`,"")),f=f.replace(`${n.split("/").slice(0,-1).join("/")}/`,""),f[0]!=="."&&(f=`./${f}`),f}};var me=e=>{let t;try{t=new URL(e).href}catch{t=T(e,globalThis.location.href)}return t},De=async(e,t={})=>{t.mode||(t.mode="cors");let r=me(e),o=t?.callbacks?.progress?.fetch,n=await ft(r,t,{path:e,progress:o});if(!n.buffer)throw new Error("No response received.");let s=n.type.split(";")[0];return{...n,url:r,type:s}},ft=async(e,t={},r)=>{let o=r.path??e,n=T($(o,t)),s=await globalThis.fetch(e,t),l=0,f=[],d=0,B=await new Promise(async E=>{if(s){d=parseInt(s.headers.get("Content-Length"),10);let c=s.headers.get("Content-Type");if(globalThis.REMOTEESM_NODE){let R=await s.arrayBuffer();E({buffer:R,type:c})}else{let R=s.body.getReader(),j=async({done:W,value:_})=>{if(W){let D={};typeof c=="string"&&(D.type=c);let J=await new Blob(f,D).arrayBuffer();E({buffer:new Uint8Array(J),type:c});return}l+=_.length;let L=_;return f.push(L),r.progress instanceof Function&&r.progress(n,l,d,null,null,s.headers.get("Range")),R.read().then(j)};R.read().then(j)}}else console.warn("Response not received!",t.headers),E(void 0)});if(r.progress instanceof Function){let E=[null,null];s.ok?E[0]=!0:E[1]=!0,r.progress(n,l,d,...E,s.headers.get("Range"))}return{response:s,...B}};var Ie=new Promise(async(e,t)=>{try{if(typeof process=="object"){globalThis.REMOTEESM_NODE=!0,globalThis.fetch=(await import("node-fetch")).default,typeof globalThis.fetch!="function"&&(globalThis.fetch=fetch);let r=(await Promise.resolve().then(()=>(_e(),$e))).default;globalThis.Blob=r,typeof globalThis.Blob!="function"&&(globalThis.Blob=r),e(!0)}else e(!0)}catch(r){t(r)}});var Ye={};P(Ye,{get:()=>Rt});var oe={};P(oe,{get:()=>mt,getURI:()=>xe});var be={};P(be,{script:()=>ye});var ye=async e=>await new Promise((t,r)=>{let o=document.createElement("script"),n=!1;o.onload=o.onreadystatechange=function(){!n&&(!this.readyState||this.readyState=="complete")&&(n=!0,t(window))},o.onerror=r,o.src=e,document.body.insertAdjacentElement("beforeend",o)});function pt(e){let t="",r=new Uint8Array(e),o=r.byteLength;for(let n=0;n<o;n++)t+=String.fromCharCode(r[n]);return window.btoa(t)}var xe=(e,t="text/javascript",r,o=!1)=>{let n=r==="buffer"?pt(e):btoa(o?unescape(encodeURIComponent(e)):e);return`data:${t};base64,`+n},ht=async(e,t)=>await(t?import(e,{assert:{type:"json"}}):import(e)).catch(r=>{throw r}),mt=async(e,t,r)=>{let o=typeof e=="string"?"text":"buffer",n,s;if(!r){let f=S(t);r=re(f)}let l=r==="application/json";try{n=xe(e,r,o),s=await ht(n,l)}catch(f){n=xe(e,r,o,!0),Me(r)?s=n=await yt(n,f).catch(d=>{throw d}):s=n}return{datauri:n,module:s}};async function yt(e,t){if(t.message.includes("The string to be encoded contains characters outside of the Latin1 range.")||t.message.includes("Cannot set properties of undefined"))return await ye(e);throw t}var ae={};P(ae,{get:()=>bt});function bt(e){typeof e=="string"&&(e=new TextEncoder().encode(e));let t=new Blob([e],{type:"text/javascript"});return URL.createObjectURL(t)}var Ne=["ts","js"],Ce=[...Ne,X],He=e=>{let t=S(e),r=H(e),o=r?e.split("/").length===1:!1,n=!t;if(!o&&r&&n){let s=Ne.map(l=>({extension:l,name:`${X.name} + ${l}`,handler:X.handler}));return e.split("/").length===1?[X,...s]:[...s,X]}else return r?[...Ce].reverse():n?[...Ce]:[]};var wt="was not resolved locally. You can provide a direct reference to use in",se=(e,t=e)=>new Error(`${e} ${wt} options.filesystem._fallbacks['${t}'].`);var ze=(e,t="js")=>{let r=H(e),o=e.split("/"),n=S(e);return(!r||r&&o.length>1)&&!n?`${e}.${t}`:e},Pe=async(e,t,r,o)=>{let n=typeof t;if(n==="string"&&(!o||o==="string"))return ze(e,t);if(n==="object"&&(!o||o==="object"))return t.extension&&(e=ze(e,t.extension)),await t.handler(e,r).catch(s=>{throw se(e,$(e,r))})};var Ut={compilerOptions:{target:"ES2015",module:"ES2020",strict:!1,esModuleInterop:!0}},Xe=(e,t="text")=>{if(window.ts){let r=t!=="buffer"?e[t].updated:new TextDecoder().decode(e[t]);return e.text.updated=window.ts.transpile(r,Ut.compilerOptions),t==="buffer"?(e.buffer=new TextEncoder().encode(e.text.updated),e.buffer):e.text.updated}else throw new Error("Must load TypeScript extension to compile TypeScript files using remoteESM.load.script(...);")};var Ft=new TextDecoder("utf-8"),ie=async(e,t,r)=>{let o=await De(e,t),n=o.response,s={uri:e,response:n,text:{original:"",updated:""},buffer:null};if(n.ok){if(r){let l=n.headers.get("Content-Type");if(!l.includes(r))throw new Error(`Expected Content Type ${r} but received ${l} for  ${e}`)}s.buffer=o.buffer,s.text.original=s.text.updated=Ft.decode(s.buffer)}else throw new Error(n.statusText);return s},ke=async(e,t,r)=>{let o=He(e),n;if(o.length>0){do{let s=o.shift(),l=s?.name??s,f=c=>{t.debug&&console.error(`Import using ${l??s} transformation failed for ${e}`)},d=await Pe(e,s,t),B=T(d,t.relativeTo);n=await r(B,t,s?null:"application/javascript").then(c=>(t.debug&&console.warn(`Import using ${l??s} transformation succeeded for ${e}`),c)).catch(f)}while(!n&&o.length>0);if(!n)throw new Error(`No valid transformation found for ${e}`)}else n=await r(T(e,t.relativeTo),t);return n},Je=async(e,t)=>{let o=S(e)==="json";return await ke(e,t,async s=>await(o?import(s,{assert:{type:"json"}}):import(s)))},Ve=async(e,t)=>{let r=await ke(e,t,ie);return r.originalURI=e,r},le=async(e,t="buffer")=>{let r=t==="text"?e.text.updated:e.buffer,o=S(e.uri),n=re(o);switch(n){case"text/typescript":r=Xe(e,t),n=Q;break}let s=await oe.get(r,e.uri,n),l=ae.get(r);return e.module=s.module,e.datauri=s.datauri,e.objecturl=l,e};var Tt=/\/\/# sourceMappingURL=(.*\.map)/,Rt=async(e,t,r,o=!0)=>{if(r||(r=(await ie(e,t)).text.original),r){let n=r.match(Tt);if(n){let s=async()=>{let l=T(n[1],e),d=(await ie(l,t)).text.original;d.slice(0,3)===")]}"&&(console.warn("Removing source map invalidation characters"),d=d.substring(d.indexOf(`
`)));let B={module:JSON.parse(d)};return B.text={original:d,updated:null},B};return o?s():s}}};var K=class{value=void 0;dependencies=new Set;dependents=new Set;constructor(){}compile=()=>{};set=t=>{this.value=t};addDependency=t=>{this.dependencies.add(t),t.dependents.add(this)};removeDependency=t=>{this.dependencies.delete(t),t.dependents.delete(this)}};globalThis.REMOTEESM_BUNDLES={global:{}};var Mt=/[^\n]*(?<![\/\/])import\s+([ \n\t]*(?:(?:\* (?:as .+))|(?:[^ \n\t\{\}]+[ \n\t]*,?)|(?:[ \n\t]*\{(?:[ \n\t]*[^ \n\t"'\{\}]+[ \n\t]*,?)+\}))[ \n\t]*)from[ \n\t]*(['"])([^'"\n]+)(?:['"])([ \n\t]*assert[ \n\t]*{type:[ \n\t]*(['"])([^'"\n]+)(?:['"])})?/gm,Ct=T,Nt=O,ge=globalThis.REMOTEESM_BUNDLES.global,we=(e,t)=>{let o=ce(t.bundle).bundle,n=[e.datauri,e.objecturl];o[e.uri]||(o[e.uri]=new K),ge[e.uri]?t.bundle!="global"&&t.debug&&console.warn("Duplicating this import. Already tracking globally...",e.uri):ge[e.uri]=o[e.uri],ge[e.uri].value=o[e.uri].value=t.bundler==="objecturl"?n[1]??n[0]:n[0]??n[1]},Bt=async(e,t,r)=>{let{variables:o,wildcard:n}=t,s=t.path,l=H(s),f;try{let d=l?s:T(s,e.uri),B=ne(r);d=d.replace(`${B}/`,"");let E=$(d,r),c=E,R=ce(r.bundle,c),j=R.bundle;if(!j.value){j.value=null;let L=!1,D=ce(r.bundle,e.uri);D.bundle.dependents.has(c)&&(L=!0),D.bundle.dependencies.add(c),j.dependencies.has(e.uri)&&(L=!0),j.dependents.add(e.uri);let k=me(d),J=E,I={output:{},...r,root:k};if(I.output.text=!0,L){let C=`Circular dependency detected: ${e.uri} <-> ${c}.`;throw new Error(C)}if(f=await jt(J,I,{original:s,transformed:d}),r.dependencies&&(r.dependencies[e.uri]||(r.dependencies[e.uri]={}),r.dependencies[e.uri][f.uri]=t),f.fallback)j.value=f.module;else{let C=await le({text:f.text,uri:c},"text");we(C,r)}}let _=j.value;return typeof _=="string"?e.text.updated=`import ${n?"* as ":""}${o} from "${_}"; // Imported from ${c}
                  ${e.text.updated}`:e.text.updated=`const ${o} = globalThis.REMOTEESM_BUNDLE["${R.id}"]["${c}"];
            ${e.text.updated}`,f}catch(d){throw d}},jt=async(e,t,r={original:e,transformed:e})=>await new Promise(async(o,n)=>{await Ke(e,{...t,onImport:(s,l)=>{t.onImport instanceof Function&&t.onImport(s,l),s==e&&o(l)}}).catch(s=>{if(s.message.includes("Circular dependency detected"))n(s);else{let l=H(r.original)?$(r.original,t,!0):$(r.transformed,t,!0);console.warn(`Failed to fetch ${e}. Checking filesystem references...`);let f=t.filesystem?._fallbacks?.[l];if(f)console.warn(`Got fallback reference (module only) for ${e}.`),Object.defineProperty({module:f},"fallback",{value:!0,enumerable:!1}),o({module:f});else{let d="was not resolved locally. You can provide a direct reference to use in";s.message.includes(d)?n(s):n(se(e,l))}}})});function ce(e,t){e||(e=Math.random());let r=globalThis.REMOTEESM_BUNDLES[e];return r||(r=globalThis.REMOTEESM_BUNDLES[e]={}),t&&(r[t]||(r[t]=new K),r=r[t]),{id:e,bundle:r}}var Ke=async(e,t={})=>{t=Object.assign({},t);let{onImport:r=()=>{},output:o={}}=t,n=0,s=0,l=t.callbacks?.progress?.file,f=typeof l=="function";try{if(!t.bundle){let c=ce(t.bundle);t.bundle=c.id}t.bundler||(t.bundler="objecturl"),await Ie;let d={},B=o.text||o.datauri||o.objecturl;d.module=B?void 0:await Je(e,t).catch(c=>{});let E=T(e);if(!d.module||B){let c=await Ve(e,t);E=T($(c.uri,t));try{d=await le(c),we(d,t)}catch{let j=[];Array.from(c.text.updated.matchAll(Mt)).forEach(L=>{c.text.updated=c.text.updated.replace(L[0],"");let D=!!L[1].match(/\*\s+as/),k=L[1].replace(/\*\s+as/,"").trim();j.push({path:L[3],variables:k,wildcard:D})}),s=j.length;let _=j.map(async L=>{await Bt(c,L,t).catch(D=>{throw console.error(D),D}),n++,f&&l(E,n,s)});await Promise.allSettled(_),d=await le(c,"text"),we(d,t)}}return f&&l(E,n,s,!0),r(e,d),d.module}catch(d){f&&l(name,n,s,null,d)}},Ht=Ke;})();
//# sourceMappingURL=index.js.map
