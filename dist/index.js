(()=>{var We=Object.create;var fe=Object.defineProperty;var Qe=Object.getOwnPropertyDescriptor;var Ze=Object.getOwnPropertyNames;var et=Object.getPrototypeOf,tt=Object.prototype.hasOwnProperty;var rt=(e=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(e,{get:(t,r)=>(typeof require!="undefined"?require:t)[r]}):e)(function(e){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var nt=(e,t)=>()=>(e&&(t=e(e=0)),t);var ot=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),P=(e,t)=>{for(var r in t)fe(e,r,{get:t[r],enumerable:!0})},at=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Ze(t))!tt.call(e,n)&&n!==r&&fe(e,n,{get:()=>t[n],enumerable:!(o=Qe(t,n))||o.enumerable});return e};var Ue=(e,t,r)=>(r=e!=null?We(et(e)):{},at(t||!e||!e.__esModule?fe(r,"default",{value:e,enumerable:!0}):r,e));var Se=ot(Z=>{(function(e){(function(t){typeof define=="function"&&define.amd?define(["exports"],t):typeof Z=="object"&&typeof Z.nodeName!="string"?t(Z):t(e)})(function(t){"use strict";var r=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder,o=e.URL||e.webkitURL||function(f,i){return i=document.createElement("a"),i.href=f,i},n=e.Blob,s=o.createObjectURL,l=o.revokeObjectURL,u=e.Symbol&&e.Symbol.toStringTag,y=!1,F=!1,A=r&&r.prototype.append&&r.prototype.getBlob;try{y=new Blob(["\xE4"]).size===2,F=new Blob([new Uint8Array([1,2])]).size===2}catch{}function h(f){return f.map(function(i){if(i.buffer instanceof ArrayBuffer){var d=i.buffer;if(i.byteLength!==d.byteLength){var p=new Uint8Array(i.byteLength);p.set(new Uint8Array(d,i.byteOffset,i.byteLength)),d=p.buffer}return d}return i})}function T(f,i){i=i||{};var d=new r;return h(f).forEach(function(p){d.append(p)}),i.type?d.getBlob(i.type):d.getBlob()}function E(f,i){return new n(h(f),i||{})}e.Blob&&(T.prototype=Blob.prototype,E.prototype=Blob.prototype);function K(f){for(var i=0,d=f.length,p=e.Uint8Array||Array,b=0,w=Math.max(32,d+(d>>1)+7),x=new p(w>>3<<3);i<d;){var c=f.charCodeAt(i++);if(c>=55296&&c<=56319){if(i<d){var M=f.charCodeAt(i);(M&64512)===56320&&(++i,c=((c&1023)<<10)+(M&1023)+65536)}if(c>=55296&&c<=56319)continue}if(b+4>x.length){w+=8,w*=1+i/f.length*2,w=w>>3<<3;var q=new Uint8Array(w);q.set(x),x=q}if((c&4294967168)===0){x[b++]=c;continue}else if((c&4294965248)===0)x[b++]=c>>6&31|192;else if((c&4294901760)===0)x[b++]=c>>12&15|224,x[b++]=c>>6&63|128;else if((c&4292870144)===0)x[b++]=c>>18&7|240,x[b++]=c>>12&63|128,x[b++]=c>>6&63|128;else continue;x[b++]=c&63|128}return x.slice(0,b)}function S(f){for(var i=f.length,d=[],p=0;p<i;){var b=f[p],w=null,x=b>239?4:b>223?3:b>191?2:1;if(p+x<=i){var c,M,q,v;switch(x){case 1:b<128&&(w=b);break;case 2:c=f[p+1],(c&192)===128&&(v=(b&31)<<6|c&63,v>127&&(w=v));break;case 3:c=f[p+1],M=f[p+2],(c&192)===128&&(M&192)===128&&(v=(b&15)<<12|(c&63)<<6|M&63,v>2047&&(v<55296||v>57343)&&(w=v));break;case 4:c=f[p+1],M=f[p+2],q=f[p+3],(c&192)===128&&(M&192)===128&&(q&192)===128&&(v=(b&15)<<18|(c&63)<<12|(M&63)<<6|q&63,v>65535&&v<1114112&&(w=v))}}w===null?(w=65533,x=1):w>65535&&(w-=65536,d.push(w>>>10&1023|55296),w=56320|w&1023),d.push(w),p+=x}for(var C=d.length,U="",z=0;z<C;)U+=String.fromCharCode.apply(String,d.slice(z,z+=4096));return U}var H=typeof TextEncoder=="function"?TextEncoder.prototype.encode.bind(new TextEncoder):K,D=typeof TextDecoder=="function"?TextDecoder.prototype.decode.bind(new TextDecoder):S;function $(){function f(a){for(var m=new Array(a.byteLength),g=new Uint8Array(a),R=m.length;R--;)m[R]=g[R];return m}function i(a){for(var m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",g=[],R=0;R<a.length;R+=3){var B=a[R],k=R+1<a.length,G=k?a[R+1]:0,ve=R+2<a.length,Fe=ve?a[R+2]:0,Ye=B>>2,Ke=(B&3)<<4|G>>4,Re=(G&15)<<2|Fe>>6,Ee=Fe&63;ve||(Ee=64,k||(Re=64)),g.push(m[Ye],m[Ke],m[Re],m[Ee])}return g.join("")}var d=Object.create||function(a){function m(){}return m.prototype=a,new m};function p(a){return Object.prototype.toString.call(a).slice(8,-1)}function b(a,m){return typeof a=="object"&&Object.prototype.isPrototypeOf.call(a.prototype,m)}function w(a){return p(a)==="DataView"||b(e.DataView,a)}var x=["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","ArrayBuffer"];function c(a,m){return a.indexOf(m)!==-1}function M(a){return c(x,p(a))||b(e.ArrayBuffer,a)}function q(a){for(var m=0,g=a.length;g--;)m+=a[g].length;for(var R=new Uint8Array(m),B=0,k=0;k<a.length;k++){var G=a[k];R.set(G,B),B+=G.byteLength||G.length}return R}function v(a,m){a=a||[],m=m??{};for(var g=0,R=a.length;g<R;g++){var B=a[g];B instanceof v?a[g]=B._buffer:typeof B=="string"?a[g]=H(B):w(B)?a[g]=f(B.buffer):M(B)?a[g]=f(B):a[g]=H(String(B))}this._buffer=e.Uint8Array?q(a):[].concat.apply([],a),this.size=this._buffer.length,this.type=m.type||"",/[^\u0020-\u007E]/.test(this.type)?this.type="":this.type=this.type.toLowerCase()}v.prototype.arrayBuffer=function(){return Promise.resolve(this._buffer.buffer||this._buffer)},v.prototype.text=function(){return Promise.resolve(D(this._buffer))},v.prototype.slice=function(a,m,g){var R=this._buffer.slice(a||0,m||this._buffer.length);return new v([R],{type:g})},v.prototype.toString=function(){return"[object Blob]"};function C(a,m,g){g=g||{};var R=v.call(this,a,g)||this;return R.name=m.replace(/\//g,":"),R.lastModifiedDate=g.lastModified?new Date(g.lastModified):new Date,R.lastModified=+R.lastModifiedDate,R}if(C.prototype=d(v.prototype),C.prototype.constructor=C,Object.setPrototypeOf)Object.setPrototypeOf(C,v);else try{C.__proto__=v}catch{}C.prototype.toString=function(){return"[object File]"};function U(){if(!(this instanceof U))throw new TypeError("Failed to construct 'FileReader': Please use the 'new' operator, this DOM object constructor cannot be called as a function.");var a=document.createDocumentFragment();this.addEventListener=a.addEventListener,this.dispatchEvent=function(m){var g=this["on"+m.type];typeof g=="function"&&g(m),a.dispatchEvent(m)},this.removeEventListener=a.removeEventListener}function z(a,m,g){if(!(m instanceof v))throw new TypeError("Failed to execute '"+g+"' on 'FileReader': parameter 1 is not of type 'Blob'.");a.result="",setTimeout(function(){this.readyState=U.LOADING,a.dispatchEvent(new Event("load")),a.dispatchEvent(new Event("loadend"))})}U.EMPTY=0,U.LOADING=1,U.DONE=2,U.prototype.error=null,U.prototype.onabort=null,U.prototype.onerror=null,U.prototype.onload=null,U.prototype.onloadend=null,U.prototype.onloadstart=null,U.prototype.onprogress=null,U.prototype.readAsDataURL=function(a){z(this,a,"readAsDataURL"),this.result="data:"+a.type+";base64,"+i(a._buffer)},U.prototype.readAsText=function(a){z(this,a,"readAsText"),this.result=D(a._buffer)},U.prototype.readAsArrayBuffer=function(a){z(this,a,"readAsText"),this.result=(a._buffer.buffer||a._buffer).slice()},U.prototype.abort=function(){},o.createObjectURL=function(a){return a instanceof v?"data:"+a.type+";base64,"+i(a._buffer):s.call(o,a)},o.revokeObjectURL=function(a){l&&l.call(o,a)};var ce=e.XMLHttpRequest&&e.XMLHttpRequest.prototype.send;ce&&(XMLHttpRequest.prototype.send=function(a){a instanceof v?(this.setRequestHeader("Content-Type",a.type),ce.call(this,D(a._buffer))):ce.call(this,a)}),t.Blob=v,t.File=C,t.FileReader=U,t.URL=o}function V(){var f=!!e.ActiveXObject||"-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style,i=e.XMLHttpRequest&&e.XMLHttpRequest.prototype.send;f&&i&&(XMLHttpRequest.prototype.send=function(d){d instanceof Blob?(this.setRequestHeader("Content-Type",d.type),i.call(this,d)):i.call(this,d)});try{new File([],""),t.File=e.File,t.FileReader=e.FileReader}catch{try{t.File=new Function('class File extends Blob {constructor(chunks, name, opts) {opts = opts || {};super(chunks, opts || {});this.name = name.replace(/\\//g, ":");this.lastModifiedDate = opts.lastModified ? new Date(opts.lastModified) : new Date();this.lastModified = +this.lastModifiedDate;}};return new File([], ""), File')()}catch{t.File=function(b,w,x){var c=new Blob(b,x),M=x&&x.lastModified!==void 0?new Date(x.lastModified):new Date;return c.name=w.replace(/\//g,":"),c.lastModifiedDate=M,c.lastModified=+M,c.toString=function(){return"[object File]"},u&&(c[u]="File"),c}}}}y?(V(),t.Blob=F?e.Blob:E):A?(V(),t.Blob=T):$(),u&&(t.File.prototype[u]||(t.File.prototype[u]="File"),t.Blob.prototype[u]||(t.Blob.prototype[u]="Blob"),t.FileReader.prototype[u]||(t.FileReader.prototype[u]="FileReader"));var O=t.Blob.prototype,I;try{new ReadableStream({type:"bytes"}),I=function(){var i=0,d=this;return new ReadableStream({type:"bytes",autoAllocateChunkSize:524288,pull:function(p){var b=p.byobRequest.view,w=d.slice(i,i+b.byteLength);return w.arrayBuffer().then(function(x){var c=new Uint8Array(x),M=c.byteLength;i+=M,b.set(c),p.byobRequest.respond(M),i>=d.size&&p.close()})}})}}catch{try{new ReadableStream({}),I=function(d){var p=0;return new ReadableStream({pull:function(b){var w=d.slice(p,p+524288);return w.arrayBuffer().then(function(x){p+=x.byteLength;var c=new Uint8Array(x);b.enqueue(c),p==d.size&&b.close()})}})}}catch{try{new Response("").body.getReader().read(),I=function(){return new Response(this).body}}catch{I=function(){throw new Error("Include https://github.com/MattiasBuelens/web-streams-polyfill")}}}}function we(f){return new Promise(function(i,d){f.onload=f.onerror=function(p){f.onload=f.onerror=null,p.type==="load"?i(f.result||f):d(new Error("Failed to read the blob/file"))}})}O.arrayBuffer||(O.arrayBuffer=function(){var i=new FileReader;return i.readAsArrayBuffer(this),we(i)}),O.text||(O.text=function(){var i=new FileReader;return i.readAsText(this),we(i)}),O.stream||(O.stream=I)})})(typeof self<"u"&&self||typeof window<"u"&&window||typeof global<"u"&&global||Z)});var De={};P(De,{default:()=>ct});var Oe,ct,$e=nt(()=>{Oe=Ue(Se(),1),ct=Oe.Blob});var _={};P(_,{absolute:()=>N,base:()=>Le,extension:()=>L,get:()=>j,noBase:()=>J,url:()=>ne});var W="application/javascript",Te=e=>!e||e==="application/javascript",ue={js:W,mjs:W,cjs:W,ts:"text/typescript",json:"application/json",html:"text/html",css:"text/css",txt:"text/plain",svg:"image/svg+xml",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",webp:"image/webp",mp3:"audio/mpeg",mp4:"video/mp4",webm:"video/webm",ogg:"application/ogg",wav:"audio/wav"},te=e=>ue[e];var pe={};P(pe,{defaults:()=>Y,getMainPath:()=>je,path:()=>re,resolve:()=>Me,transformation:()=>X});var Y={nodeModules:"node_modules",rootRelativeTo:"./"},re=e=>{let t=e.nodeModules??Y.nodeModules,r=e.rootRelativeTo??Y.rootRelativeTo;return j(t,r)},Me=async(e,t)=>{let r=re(t),o=e.split("/"),n=j(e,r);if(o.length>1){if(L(n))return n;n+="/package.json"}return await je(e,n).catch(s=>{console.warn(`${n} does not exist or is not at the root of the project.`)})},Be=(e,t,r)=>j(e,r,!1,t.split("/").length===1),st=(e,t=e)=>Be("package.json",e,t),je=async(e,t=e)=>{let r=await it(e,t);if(!r)return t;let o=r.module||r.main||"index.js";return Be(o,e,t)},it=async(e,t=e)=>{let r=st(e,t);return(await import(ne(r)?r:new URL(r,window.location.href).href,{assert:{type:"json"}})).default},X={name:"node_modules",handler:Me};var Q="://",j=(e,t="",r=!1,o=!1)=>{let n="",s=h=>(n=h.includes(Q)?h.split(Q).splice(0,1):void 0,n?h.replace(`${n}${Q}`,""):h);e.includes(Q)&&(e=s(e)),t.includes(Q)&&(t=s(t)),r||(t=t.split("/").filter(h=>h!="..").join("/")),t[t.length-1]==="/"&&(t=t.slice(0,-1));let l=t.split("/");if(l.length===1&&l[0]===""&&(l=[]),!o){let h=l.pop();if(h){let T=h.split(".");(T.length==1||T.length>1&&T.includes(""))&&l.push(h)}}let F=e.split("/").filter((h,T)=>!!h).filter((h,T)=>h===".."?(l.pop(),!1):h!=="."),A=[...l,...F].join("/");return n?n+"://"+A:A};function N(e){let t=e[0]!==".",r=ne(e);return t&&!r}function ne(e){try{return new URL(e),!0}catch{return!1}}var L=e=>{let t=e.split("/").slice(-1)[0].split(".").slice(-1)[0];if(ue[t])return t},Le=e=>e.substring(0,e.lastIndexOf("/")),J=(e,t)=>{let r=N(e),o=t.rootRelativeTo??Y.rootRelativeTo,n=t.nodeModules??Y.nodeModules,s=globalThis.location?e.replace(`${Le(globalThis.location.href)}/`,""):e;if(r)return s;{let l=s.replace(`${n}/`,"").replace(`${o.split("/").slice(0,-1).join("/")}/`,"");return l[0]!=="."&&(l=`./${l}`),l}};var me=e=>{let t;try{t=new URL(e).href}catch{t=j(e,globalThis.location.href)}return t},Ae=async(e,t={})=>{t.mode||(t.mode="cors");let r=me(e),o=t?.callbacks?.progress?.fetch,n=await lt(r,t,o);if(!n.buffer)throw new Error("No response received.");let s=n.type.split(";")[0];return{...n,url:r,type:s}},lt=async(e,t={},r)=>{let o=await globalThis.fetch(e,t),n=await new Promise(async s=>{if(o){let l=o.headers.get("Content-Type");if(globalThis.REMOTEESM_NODE){let u=await o.arrayBuffer();s({buffer:u,type:l})}else{let u=o.body.getReader(),y=parseInt(o.headers.get("Content-Length"),10),F=0,A=[],h=async({done:T,value:E})=>{if(T){let S={};typeof l=="string"&&(S.type=l);let D=await new Blob(A,S).arrayBuffer();s({buffer:new Uint8Array(D),type:l}),r instanceof Function&&r(e,F,y,T,o.headers.get("Range"));return}F+=E.length;let K=E;return A.push(K),r instanceof Function&&r(e,F,y,o.headers.get("Range")),u.read().then(h)};u.read().then(h)}}else console.warn("Response not received!",t.headers),s(void 0)});return{response:o,...n}};var _e=new Promise(async(e,t)=>{try{if(typeof process=="object"){globalThis.REMOTEESM_NODE=!0,globalThis.fetch=(await import("node-fetch")).default,typeof globalThis.fetch!="function"&&(globalThis.fetch=fetch);let r=(await Promise.resolve().then(()=>($e(),De))).default;globalThis.Blob=r,typeof globalThis.Blob!="function"&&(globalThis.Blob=r),e(!0)}else e(!0)}catch(r){t(r)}});var Ve={};P(Ve,{get:()=>Et});var oe={};P(oe,{get:()=>pt,getURI:()=>be});var ye={};P(ye,{script:()=>he});var he=async e=>await new Promise((t,r)=>{let o=document.createElement("script"),n=!1;o.onload=o.onreadystatechange=function(){!n&&(!this.readyState||this.readyState=="complete")&&(n=!0,t(window))},o.onerror=r,o.src=e,document.body.insertAdjacentElement("beforeend",o)});function ut(e){let t="",r=new Uint8Array(e),o=r.byteLength;for(let n=0;n<o;n++)t+=String.fromCharCode(r[n]);return window.btoa(t)}var be=(e,t="text/javascript",r,o=!1)=>{let n=r==="buffer"?ut(e):btoa(o?unescape(encodeURIComponent(e)):e);return`data:${t};base64,`+n},dt=async(e,t)=>await(t?import(e,{assert:{type:"json"}}):import(e)).catch(r=>{throw r}),pt=async(e,t,r)=>{let o=typeof e=="string"?"text":"buffer",n,s;if(!r){let u=L(t);r=te(u)}let l=r==="application/json";try{n=be(e,r,o),s=await dt(n,l)}catch(u){n=be(e,r,o,!0),Te(r)?s=n=await mt(n,u).catch(y=>{throw y}):s=n}return{datauri:n,module:s}};async function mt(e,t){if(t.message.includes("The string to be encoded contains characters outside of the Latin1 range.")||t.message.includes("Cannot set properties of undefined"))return await he(e);throw t}var ae={};P(ae,{get:()=>ht});function ht(e){typeof e=="string"&&(e=new TextEncoder().encode(e));let t=new Blob([e],{type:"text/javascript"});return URL.createObjectURL(t)}var Ce=["ts","js"],Ie=[...Ce,X],Ne=e=>{let t=L(e),r=N(e),o=r?e.split("/").length===1:!1,n=!t;if(!o&&r&&n){let s=Ce.map(l=>({extension:l,name:`${X.name} + ${l}`,handler:X.handler}));return e.split("/").length===1?[X,...s]:[...s,X]}else return r?[...Ie].reverse():n?[...Ie]:[]};var xt="was not resolved locally. You can provide a direct reference to use in",se=(e,t=e)=>new Error(`${e} ${xt} options.filesystem._fallbacks['${t}'].`);var qe=(e,t="js")=>{let r=N(e),o=e.split("/"),n=L(e);return(!r||r&&o.length>1)&&!n?`${e}.${t}`:e},ze=async(e,t,r,o)=>{let n=typeof t;if(n==="string"&&(!o||o==="string"))return qe(e,t);if(n==="object"&&(!o||o==="object"))return t.extension&&(e=qe(e,t.extension)),await t.handler(e,r).catch(s=>{throw se(e,J(e,r))})};var wt={compilerOptions:{target:"ES2015",module:"ES2020",strict:!1,esModuleInterop:!0}},Pe=(e,t="text")=>{if(window.ts){let r=t!=="buffer"?e[t].updated:new TextDecoder().decode(e[t]);return e.text.updated=window.ts.transpile(r,wt.compilerOptions),t==="buffer"?(e.buffer=new TextEncoder().encode(e.text.updated),e.buffer):e.text.updated}else throw new Error("Must load TypeScript extension to compile TypeScript files using remoteESM.load.script(...);")};var Ft=new TextDecoder("utf-8"),ee=async(e,t,r)=>{let o=await Ae(e,t),n=o.response,s={uri:e,response:n,text:{original:"",updated:""},buffer:null};if(n.ok){if(r){let l=n.headers.get("Content-Type");if(!l.includes(r))throw new Error(`Expected Content Type ${r} but received ${l} for  ${e}`)}s.buffer=o.buffer,s.text.original=s.text.updated=Ft.decode(s.buffer)}else throw new Error(n.statusText);return s},Xe=async(e,t)=>{let r=Ne(e),o;if(r.length>0){do{let n=r.shift(),s=n?.name??n,l=F=>{console.error(`Import using ${s??n} transformation failed for ${e}`)},u=await ze(e,n,t);o=await ee(u,t,n?null:"application/javascript").then(F=>(t.debug&&console.warn(`Import using ${s??n} transformation succeeded for ${e}`),F)).catch(l)}while(!o&&r.length>0);if(!o)throw new Error(`No valid transformation found for ${e}`)}else o=await ee(e,t);return o.originalURI=e,o},ie=async(e,t="buffer")=>{let r=t==="text"?e.text.updated:e.buffer,o=L(e.uri),n=te(o);switch(n){case"text/typescript":r=Pe(e,t),n=W;break}let s=await oe.get(r,e.uri,n),l=ae.get(r);return e.module=s.module,e.datauri=s.datauri,e.objecturl=l,e};var Rt=/\/\/# sourceMappingURL=(.*\.map)/,Et=async(e,t,r,o=!0)=>{if(r||(r=(await ee(e,t)).text.original),r){let n=r.match(Rt);if(n){let s=async()=>{let l=j(n[1],e),y=(await ee(l,t)).text.original;y.slice(0,3)===")]}"&&(console.warn("Removing source map invalidation characters"),y=y.substring(y.indexOf(`
`)));let F={module:JSON.parse(y)};return F.text={original:y,updated:null},F};return o?s():s}}};globalThis.REMOTEESM_BUNDLES={global:{}};var Ut=/[^\n]*(?<![\/\/])import\s+([ \n\t]*(?:(?:\* (?:as .+))|(?:[^ \n\t\{\}]+[ \n\t]*,?)|(?:[ \n\t]*\{(?:[ \n\t]*[^ \n\t"'\{\}]+[ \n\t]*,?)+\}))[ \n\t]*)from[ \n\t]*(['"])([^'"\n]+)(?:['"])([ \n\t]*assert[ \n\t]*{type:[ \n\t]*(['"])([^'"\n]+)(?:['"])})?/gm,Dt=j,$t=_,xe=globalThis.REMOTEESM_BUNDLES.global,ge=(e,t)=>{let o=le(t.bundle).bundle,n=[e.datauri,e.objecturl];o[e.uri]||(o[e.uri]=ke()),xe[e.uri]?t.bundle!="global"&&t.debug&&console.warn("Duplicating this import. Already tracking globally...",e.uri):xe[e.uri]=o[e.uri],xe[e.uri].value=o[e.uri].value=t.bundler==="objecturl"?n[1]??n[0]:n[0]??n[1]},Tt=async(e,t,r)=>{let{variables:o,wildcard:n}=t,s=t.path,l=N(s),u;try{let y=l?s:j(s,e.uri),F=re(r);y=y.replace(`${F}/`,"");let A=J(y,r),h=A,T=le(r.bundle,h),E=T.bundle;if(!E.value){E.value=null;let H=!1,D=le(r.bundle,e.uri);D.bundle.dependents.has(h)&&(H=!0),D.bundle.dependencies.add(h),E.dependencies.has(e.uri)&&(H=!0),E.dependents.add(e.uri);let $=me(y),V=A,O={output:{},...r,root:$};if(O.output.text=!0,H){let I=`Circular dependency detected: ${e.uri} <-> ${h}.`;throw new Error(I)}if(u=await Mt(V,O,{original:s,transformed:y}),r.dependencies&&(r.dependencies[e.uri]||(r.dependencies[e.uri]={}),r.dependencies[e.uri][u.uri]=t),u.fallback)E.value=u.module;else{let I=await ie({text:u.text,uri:h},"text");ge(I,r)}}let S=E.value;return typeof S=="string"?e.text.updated=`import ${n?"* as ":""}${o} from "${S}"; // Imported from ${h}
                  ${e.text.updated}`:e.text.updated=`const ${o} = globalThis.REMOTEESM_BUNDLE["${T.id}"]["${h}"];
            ${e.text.updated}`,u}catch(y){throw y}},Mt=async(e,t,r={original:e,transformed:e})=>await new Promise(async(o,n)=>{await Ge(e,{...t,onImport:(s,l)=>{t.onImport instanceof Function&&t.onImport(s,l),s==e&&o(l)}}).catch(s=>{if(s.message.includes("Circular dependency detected"))n(s);else{let l=N(r.original)?J(r.original,t):J(r.transformed,t);console.warn(`Failed to fetch ${e}. Checking filesystem references...`);let u=t.filesystem?._fallbacks?.[l];if(u)console.warn(`Got fallback reference (module only) for ${e}.`),Object.defineProperty({module:u},"fallback",{value:!0,enumerable:!1}),o({module:u});else{let y="was not resolved locally. You can provide a direct reference to use in";s.message.includes(y)?n(s):n(se(e,l))}}})});function ke(){return{value:void 0,dependencies:new Set,dependents:new Set}}function le(e,t){e||(e=Math.random());let r=globalThis.REMOTEESM_BUNDLES[e];return r||(r=globalThis.REMOTEESM_BUNDLES[e]={}),t&&(r[t]||(r[t]=ke()),r=r[t]),{id:e,bundle:r}}var Ge=async(e,t={})=>{console.log("opts",t),t=Object.assign({},t);let{onImport:r=()=>{},output:o={},forceImportFromText:n}=t,s=0,l=0,u=t.callbacks?.progress?.file,y=typeof u=="function";if(!t.bundle){let E=le(t.bundle);t.bundle=E.id}t.bundler||(t.bundler="objecturl"),await _e;let F={},h=L(e)==="json";F.module=n?void 0:await(h?import(e,{assert:{type:"json"}}):import(e)).catch(()=>{});let T=j(e);if(!F.module||o.text||o.datauri){let E=await Xe(e,t);T=j(E.uri);try{F=await ie(E),ge(F,t)}catch{let S=[];Array.from(E.text.updated.matchAll(Ut)).forEach($=>{E.text.updated=E.text.updated.replace($[0],"");let V=!!$[1].match(/\*\s+as/),O=$[1].replace(/\*\s+as/,"").trim();S.push({path:$[3],variables:O,wildcard:V})}),l=S.length;let D=S.map(async $=>{await Tt(E,$,t),s++,y&&u(T,s,l)});await Promise.allSettled(D),F=await ie(E,"text"),ge(F,t)}}return y&&u(T,s,l,!0),r(e,F),F.module},_t=Ge;})();
//# sourceMappingURL=index.js.map
