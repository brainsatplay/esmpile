(()=>{var ve=Object.create;var F=Object.defineProperty;var $e=Object.getOwnPropertyDescriptor;var Be=Object.getOwnPropertyNames;var Se=Object.getPrototypeOf,Re=Object.prototype.hasOwnProperty;var A=(t=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(t,{get:(e,s)=>(typeof require!="undefined"?require:e)[s]}):t)(function(t){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var E=(t,e)=>{for(var s in e)F(t,s,{get:e[s],enumerable:!0})},ke=(t,e,s,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Be(e))!Re.call(t,i)&&i!==s&&F(t,i,{get:()=>e[i],enumerable:!(n=$e(e,i))||n.enumerable});return t};var J=(t,e,s)=>(s=t!=null?ve(Se(t)):{},ke(e||!t||!t.__esModule?F(s,"default",{value:t,enumerable:!0}):s,t));var N={};E(N,{Bundle:()=>et,bundle:()=>Q,compile:()=>Ue,default:()=>tt,load:()=>L,nodeModules:()=>O,path:()=>Ze,resolve:()=>Xe,sourceMap:()=>_});var g={};E(g,{absolute:()=>b,base:()=>te,extension:()=>p,get:()=>u,noBase:()=>x,pathId:()=>R,url:()=>v});var y="application/javascript",ee=t=>!t||t==="application/javascript",V={js:y,mjs:y,cjs:y,ts:"text/typescript",json:"application/json",html:"text/html",css:"text/css",txt:"text/plain",svg:"image/svg+xml",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",webp:"image/webp",mp3:"audio/mpeg",mp4:"video/mp4",webm:"video/webm",ogg:"application/ogg",wav:"audio/wav"},S=t=>V[t];var M={nodeModules:{nodeModules:"node_modules",relativeTo:"./"}};var j="://",u=(t,e="",s=!1,n=!1)=>{if(v(t))return t;let i="",o=c=>(i=c.includes(j)?c.split(j).splice(0,1):void 0,i?c.replace(`${i}${j}`,""):c);t.includes(j)&&(t=o(t)),e.includes(j)&&(e=o(e)),s||(e=e.split("/").filter(c=>c!="..").join("/")),e[e.length-1]==="/"&&(e=e.slice(0,-1));let r=e.split("/");if(r.length===1&&r[0]===""&&(r=[]),!n){let c=r.pop();if(c){let d=c.split(".");(d.length==1||d.length>1&&d.includes(""))&&r.push(c)}}let f=t.split("/").filter((c,d)=>!!c).filter((c,d)=>c===".."?(r.pop(),!1):c!=="."),h=[...r,...f].join("/");return i?i+"://"+h:h};function b(t,e){let s=t[0]!==".",n=v(t);return s&&(e||!n)}function v(t){try{return new URL(t),!0}catch{return!1}}var p=t=>{let e=t.split("/").slice(-1)[0].split(".").slice(-1)[0];if(V[e])return e},te=t=>t.substring(0,t.lastIndexOf("/")),x=(t,e,s)=>{t=globalThis.location?t.replace(`${te(globalThis.location.href)}/`,"./"):t;let n=b(t,!0),i=e.relativeTo??M.nodeModules.relativeTo,o=e.nodeModules??M.nodeModules.nodeModules;if(n)return t;{let r=t;return s&&(r=r.replace(`${o}/`,"")),r=r.replace(`${i.split("/").slice(0,-1).join("/")}/`,""),r[0]!=="."&&(r=`./${r}`),r}},R=(t,e)=>u(x(t,e));var O={};E(O,{getMainPath:()=>ne,path:()=>k,resolve:()=>se,transformation:()=>T});var k=t=>{let e=t.nodeModules??M.nodeModules.nodeModules,s=t.relativeTo??M.nodeModules.relativeTo;return u(e,s)},se=async(t,e)=>{let s=k(e),n=t.split("/"),i=u(t,s);if(n.length>1){if(p(i))return i;i+="/package.json"}return await ne(t,i,e).catch(o=>{console.warn(`${i} does not exist or is not at the root of the project.`)})},ie=(t,e,s)=>u(t,s,!1,e.split("/").length===1),Oe=(t,e=t)=>ie("package.json",t,e),ne=async(t,e=t,s={})=>{let n=await Ie(t,e,s);if(!n)return e;let i=n.module||n.main||"index.js";return ie(i,t,e)},Ie=async(t,e=t,s)=>{let n=Oe(t,e),o=v(n)?n:new URL(n,window.location.href).href;return(await fetch(o).then(a=>a.json())).default},T={name:"node_modules",handler:se};var _={};E(_,{get:()=>G});var re=["ts","js"],oe=[...re,T],ae=t=>{let e=p(t),s=b(t),n=s?t.split("/").length===1:!1,i=!e;if(!n&&s&&i){let o=re.map(r=>({extension:r,name:`${T.name} + ${r}`,handler:T.handler}));return t.split("/").length===1?[T,...o]:[...o,T]}else return s?[...oe].reverse():i?[...oe]:[]};var _e="was not resolved locally. You can provide a direct reference to use in",I=(t,e=t)=>new Error(`${t} ${_e} options.filesystem._fallbacks['${e}'].`);var ce=(t,e="js")=>{let s=b(t),n=t.split("/"),i=p(t);return(!s||s&&n.length>1)&&!i?`${t}.${e}`:t},fe=async(t,e,s,n)=>{let i=typeof e;if(i==="string"&&(!n||n==="string"))return ce(t,e);if(i==="object"&&(!n||n==="object"))return e.extension&&(t=ce(t,e.extension)),await e.handler(t,s).catch(o=>{throw I(t,x(t,s))})};var Ce=t=>{let e;try{e=new URL(t).href}catch{e=u(t,globalThis.location.href)}return e},de=async(t,e={})=>{e.fetch||(e.fetch={}),e.fetch.mode||(e.fetch.mode="cors");let s=Ce(t),n=e?.callbacks?.progress?.fetch,i=await De(s,e,{path:t,progress:n});if(!i.buffer)throw new Error("No response received.");let o=i.type.split(";")[0];return{...i,url:s,type:o}},De=async(t,e={},s)=>{let n=s.path??t,i=u(x(n,e)),o=await globalThis.fetch(t,e.fetch),r=0,a=[],l=0,f=typeof s.progress=="function",h=await new Promise(async d=>{if(o){l=parseInt(o.headers.get("Content-Length"),10);let w=o.headers.get("Content-Type");if(globalThis.REMOTEESM_NODE){let m=await o.arrayBuffer();d({buffer:m,type:w})}else{let m=o.body.getReader(),$=async({done:B,value:X})=>{if(B){let Z={};typeof w=="string"&&(Z.type=w);let je=await new Blob(a,Z).arrayBuffer();d({buffer:new Uint8Array(je),type:w});return}r+=X.length;let Me=X;return a.push(Me),f&&s.progress(i,r,l,null,null,o.headers.get("Range")),m.read().then($)};m.read().then($)}}else console.warn("Response not received!",e.headers),d(void 0)}),c={response:o,...h};if(f){let d=[null,null];o.ok?d[0]=c:d[1]=c,s.progress(i,r,l,...d,o.headers.get("Range"))}return c};var he=new TextDecoder("utf-8"),P=async(t,e,s)=>{let n={uri:t,text:{original:"",updated:""},buffer:null};if(globalThis.REMOTEESM_NODE){let i=t.replace("file://","");n.buffer=globalThis.fs.readFileSync(i),n.text.original=n.text.updated=he.decode(n.buffer)}else{let i=await de(t,e),o=i.response;if(n.response=o,o.ok){if(s){let r=o.headers.get("Content-Type");if(!r.includes(s))throw new Error(`Expected Content Type ${s} but received ${r} for  ${t}`)}n.buffer=i.buffer,n.text.original=n.text.updated=he.decode(n.buffer)}else throw new Error(o.statusText)}return n},ue=async(t,e,s)=>{let n=ae(t),i;if(n.length>0){do{let o=n.shift(),r=o?.name??o,a=c=>{e.debug&&console.error(`Import using ${r??o} transformation failed for ${t}`)},l=await fe(t,o,e),f=u(l,e.relativeTo);i=await s(f,e,o?null:"application/javascript").then(c=>(e.debug&&console.warn(`Import using ${r??o} transformation succeeded for ${t}`),c)).catch(a)}while(!i&&n.length>0);if(!i)throw new Error(`No valid transformation found for ${t}`)}else i=await s(u(t,e.relativeTo),e);return i},pe=async(t,e)=>{let n=p(t)==="json",i={};return await ue(t,e,async o=>{i.uri=o,i.result=await(n?fetch(o).then(r=>r.json()):import(o))}),i},me=async(t,e)=>await ue(t,e,P);var Ne=/\/\/# sourceMappingURL=(.*\.map)/,G=async(t,e,s,n=!0)=>{if(s||(s=(await P(t,e)).text.original),s){let i=s.match(Ne);if(i){let o=async()=>{let r=u(i[1],t),l=(await P(r,e)).text.original;l.slice(0,3)===")]}"&&(console.warn("Removing source map invalidation characters"),l=l.substring(l.indexOf(`
`)));let f={result:JSON.parse(l)};return f.text={original:l,updated:null},f};return n?o():o}}};var L={};E(L,{script:()=>W});var W=async t=>await new Promise((e,s)=>{let n=document.createElement("script"),i=!1;n.onload=n.onreadystatechange=function(){!i&&(!this.readyState||this.readyState=="complete")&&(i=!0,e(window))},n.onerror=s,n.src=t,document.body.insertAdjacentElement("beforeend",n)});var Q={};E(Q,{default:()=>U,get:()=>D});var q={};E(q,{datauri:()=>Ve,objecturl:()=>Ye});function Fe(t){let e="",s=new Uint8Array(t),n=s.byteLength;for(let i=0;i<n;i++)e+=String.fromCharCode(s[i]);return window.btoa(e)}var be=(t,e=y,s=!1)=>{let i=(typeof t=="string"?"text":"buffer")==="buffer"?Fe(t):btoa(s?unescape(encodeURIComponent(t)):t);return`data:${e};base64,`+i};function we(t,e=y){typeof t=="string"&&(t=new TextEncoder().encode(t));let s=new Blob([t],{type:e});return URL.createObjectURL(s)}var Ve=async(...t)=>await ye(be,...t),Ye=async(...t)=>await ye(we,...t),Ge=async(t,e)=>await(e?fetch(t).then(s=>s.json()):import(t)).catch(s=>{throw s});async function ye(t,e,s,n){let i,o;if(!n){let a=p(s);n=S(a)}let r=n==="application/json";try{i=t(e,n),o=await Ge(i,r)}catch(a){i=t(e,n,!0),ee(n)?o=i=await We(i,a).catch(l=>{throw l}):o=i}return{encoded:i,module:o}}async function We(t,e){if(e.message.includes("The string to be encoded contains characters outside of the Latin1 range.")||e.message.includes("Cannot set properties of undefined"))return await W(t);throw e}var qe={compilerOptions:{target:"ES2015",module:"ES2020",strict:!1,esModuleInterop:!0}},xe=(t,e="text")=>{if(window.ts){let s=e!=="buffer"?t[e].updated:new TextDecoder().decode(t[e]);return t.text.updated=window.ts.transpile(s,qe.compilerOptions),e==="buffer"?(t.buffer=new TextEncoder().encode(t.text.updated),t.buffer):t.text.updated}else throw new Error("Must load TypeScript extension to compile TypeScript files using remoteESM.load.script(...);")};var z,Ee,Te,He=new Promise(async(t,e)=>{try{if(typeof process=="object"){if(z||(globalThis.REMOTEESM_NODE=!0,z=globalThis.fetch=(await import("node-fetch")).default,typeof globalThis.fetch!="function"&&(globalThis.fetch=z)),Ee||(Ee=globalThis.fs=(await import("fs")).default),!Te){let s=(await import("node:buffer")).default;Te=globalThis.Blob=s.Blob}t(!0)}else t(!0)}catch(s){e(s)}}),H=He;globalThis.REMOTEESM_BUNDLES||(globalThis.REMOTEESM_BUNDLES={global:{}});var C=globalThis.REMOTEESM_BUNDLES.global,K="No buffer or text to bundle for",Qe=/[^\n]*(?<![\/\/])(import)\s+([ \t]*(?:(?:\* (?:as .+))|(?:[^ \t\{\}]+[ \t]*,?)|(?:[ \t]*\{(?:[ \t]*[^ \t"'\{\}]+[ \t]*,?)+\}))[ \t]*)from[ \t]*(['"])([^'"\n]+)(?:['"])([ \t]*assert[ \t]*{[ \n\t]*type:[ \n\t]*(['"])([^'"\n]+)(?:['"])[\n\t]*})?;?/gm;function D(t,e=this.options){let s=t?R(t,e):void 0,n=globalThis.REMOTEESM_BUNDLES[e.collection];n||(n=globalThis.REMOTEESM_BUNDLES[e.collection]={});let i=n[s];return i?e&&(i.options=e):i=new U(t,e),i}var U=class{filename="bundle.esmpile.js";uri;#t;get url(){return this.#t}set url(e){let s=this.options._esmpile;s.entrypoint||(s.entrypoint=this),this.uri||(this.uri=e),!b(e,!0)&&!e.includes(this.#e.relativeTo)&&(e=u(e,this.#e.relativeTo)),this.#t=e;let i=R(this.url,this.options);this.name!==i&&(this.name=i),this.updateCollection(this.options.collection)}status=null;#e;get options(){return this.#e}set options(e={}){e._esmpile||(e._esmpile=this.#e?._esmpile??{circular:new Set}),e.collection||(e.collection=this.#e?.collection),this.#e=e,e.output||(e.output={}),this.bundler=e.bundler,this.updateCollection(this.options.collection),typeof e?.callbacks?.progress?.file=="function"&&(this.callbacks.file=e.callbacks.progress.file),e.fetch||(e.fetch={}),e.fetch=Object.assign({},e.fetch),e.fetch.signal=this.controller.signal}controller=new AbortController;#s;get bundler(){return this.#s}set bundler(e){this.setBundleInfo(e),this.setBundler(e,!1)}setBundleInfo=e=>{this.#e._esmpile.lastBundler=this.#s,this.#s=this.#e.bundler=e;let s=this.#e.output;e&&(s[e]=!0,s.text=!0),this.derived.compile=!this.#e.forceNativeImport&&(s.text||s.datauri||s.objecturl)};setBundler=async(e,s=!0)=>{s&&this.setBundleInfo(e);let n=this.#e._esmpile,i=n.lastBundle,o=n.lastBundle===e;if(!o||n.lastBundle&&o&&!i){let r=n.entrypoint;if(e){let l=Array.from(this.dependencies.entries());await Promise.all(l.map(async([f,h])=>{h.bundler=e,await h.result}))}["success","failed"].includes(r?.status)&&(e?i?this.encoded=await this.bundle(i):this.result=await this.resolve():this.result=await this.resolve())}};#i;get name(){return this.#i}set name(e){if(e!==this.#i){let s=globalThis.REMOTEESM_BUNDLES[this.collection];s&&(C[this.name]===s[this.name]&&delete C[this.name],delete s[this.name]),this.#i=e;let i=e.split("/").pop().split(".");this.filename=[...i.slice(0,-1),"esmpile","js"].join("."),C[this.name]?this.options.collection!="global"&&console.warn(`Duplicating global bundle (${this.name})`,this.name):C[this.name]=this}}#n;get collection(){return this.#n}set collection(e){this.#n=e;let s=globalThis.REMOTEESM_BUNDLES[e];s||(s=globalThis.REMOTEESM_BUNDLES[e]={}),this.name&&(s[this.name]?s[this.name]!==this&&console.warn(`Trying to duplicate bundle in bundle ${e} (${this.name})`,this.name):s[this.name]=this)}#o;#r;get text(){return this.#o}set text(e){this.#o=e,this.encoded=this.bundle("text").catch(s=>{if(!s.message.includes(K))throw s})}set buffer(e){this.#r=e,this.encoded=this.bundle("buffer").catch(s=>{if(!s.message.includes(K))throw s})}dependencies=new Map;dependents=new Map;get entries(){let e=[],s=n=>{n.dependencies.forEach(i=>{!e.includes(i)&&i!==this&&(e.push(i),s(i))})};return s(this),e}encodings={};info={};imports=[];link=void 0;result=void 0;callbacks={file:void 0};derived={compile:!1,dependencies:{n:0,resolved:0}};constructor(e,s={}){this.options=s,this.url=e}import=async()=>{this.status="importing";let e=await pe(this.url,this.options);if(e?.result)return e.result;this.status="fallback"};get=D;compile=async()=>{this.status="compiling",await H;try{let e=await me(this.url,this.options).catch(s=>{throw s});try{e&&(this.info=e,this.url=this.info.uri,this.buffer=this.info.buffer,await this.encoded)}catch{this.imports={};let n=[];Array.from(this.info.text.updated.matchAll(Qe)).forEach(([r,a,l,f,h])=>{if(h){let c=!!l.match(/\*\s+as/),d=l.replace(/\*\s+as/,"").trim(),m=b(h)?h:u(h,this.url),$=k(this.options);m=m.replace(`${$}/`,"");let B={name:m,path:h,prefix:a,variables:d,wildcard:c,current:{line:r,path:h},original:r,counter:0,bundle:null};this.imports[m]||(this.imports[m]=[]),this.imports[m].push(B),n.push(B)}}),this.derived.dependencies.resolved=0,this.derived.dependencies.n=this.imports.length;let o=n.map(async(r,a)=>{await this.setImport(r,a),this.derived.dependencies.resolved++});await Promise.all(o),this.text=this.info.text.updated}}catch(e){throw e}return await this.encoded,this.result};updateImport=(e,s)=>{if(s===e.current.path)return;let{prefix:n,variables:i,wildcard:o,bundle:r}=e,a="";if(typeof s=="string")a=`${n} ${o?"* as ":""}${i} from "${s}"; // Imported from ${r.name}

`;else{let f=i.replace("{","").replace("}","")===i,h=i.replace("{","").replace("}","").split(",").map(d=>d.trim()),c=d=>{let w="";o||(f?w=".default":w=`.${d}`),a+=`${n==="import"?"":"export "}const ${d} = (await globalThis.REMOTEESM_BUNDLES["${r.collection}"]["${r.name}"].result)${w};

`};h.forEach(c)}this.info.text.updated=this.info.text.updated.replace(e.current.line,a),e.current.line=a,e.current.path=s};setImport=async e=>{let s=e.path,n=e.name,i=this.get(n);if(e.bundle=i,this.addDependency(i),i.status)await i.result;else{let r={output:{},...this.options};r.output.text=!0,await(await this.get(n,r)).resolve(s)}let o=await i.encoded;return this.updateImport(e,o),i};notify=(e,s)=>{let n=e!==void 0,i=s!==void 0;this.callbacks.file&&this.callbacks.file(this.name,this.derived.dependencies.resolved,this.derived.dependencies.n,n?this:void 0,i?s:void 0)};get buffer(){return this.#r}bundle=(e="buffer")=>(this.options._esmpile.lastBundle=e,new Promise(async(s,n)=>{try{let i=e==="text"?this.info.text.updated:this.buffer;i||(this.info.fallback?this.encoded=this.info.fallback:n(new Error(`${K} ${this.name}`)));let o=p(this.url),r=S(o);switch(r){case"text/typescript":i=xe(this.info,e),r=y;break}let a=[],l=this.options.output;l?.datauri&&a.push("datauri"),l?.objecturl&&a.push("objecturl");for(let h in a){let c=a[h],d=await q[c](i,this.url,r);d&&(this.result=d.module,this.encodings[c]=await d.encoded)}let f=this.bundler==="objecturl"?this.encodings.objecturl:this.encodings.datauri;s(f)}catch(i){n(i)}}));delete=()=>{this.objecturl&&window.URL.revokeObjectURL(this.objecturl)};addDependency=e=>{let s=!1;this.dependents.has(e.url)&&(s=!0),this.dependencies.set(e.url,e),e.dependencies.has(this.url)&&(s=!0),e.dependents.set(this.url,this),s&&(this.circular(e),e.circular(this))};removeDependency=e=>{this.dependencies.delete(e.name),e.dependents.delete(this.name)};updateDependency=async(e,s)=>{this.imports[e.url].forEach(i=>this.updateImport(i,s))};updateCollection=e=>{e?this.collection=e:this.collection=this.options.collection=Object.keys(globalThis.REMOTEESM_BUNDLES).length};download=async(e=this.filename)=>{this.bundler!="datauri"&&await this.setBundler("datauri");let s=this.encodings.datauri.split(",")[0].split(":")[1].split(";")[0],n=atob(this.encodings.datauri.split(",")[1]),i=[];for(var o=0;o<n.length;o++)i.push(n.charCodeAt(o));let r=new Uint8Array(i),a=new Blob([r],{type:s}),l=URL.createObjectURL(a);if(globalThis.REMOTEESM_NODE)await H,globalThis.fs.writeFileSync(e,r),console.log(`Wrote bundle contents to ${e}`);else{var f=document.createElement("a");document.body.appendChild(f),f.style="display: none",f.href=l,f.download=e,f.click()}};circular=async e=>{this.options._esmpile.circular.add(this.url);let s=await this.resolve().catch(n=>{console.warn(`Circular dependency detected: Fallback to direct import for ${this.url} failed...`,n);let i=`Circular dependency cannot be resolved: ${this.uri} <-> ${e.uri}.`;throw new Error(i)});console.warn(`Circular dependency detected: Fallback to direct import for ${this.url} was successful!`,s)};resolve=async(e=this.uri)=>(this.status="resolving",this.result=void 0,this.encoded=void 0,this.result=new Promise(async(s,n)=>{let i,o=this.options._esmpile.circular.has(this.url),r=o||!this.derived.compile;try{i=r?await this.import().catch(async a=>{if(this.#e.fallback===!1)throw a;await this.setBundler("objecturl")}):void 0;try{if(!i){if(o)throw new Error(`Failed to import ${this.url} natively.`);i=await this.compile()}}catch(a){if(this.options.fetch?.signal?.aborted)throw a;{let l=b(e)?x(e,this.options,!0):x(this.url,this.options,!0);console.warn(`Failed to fetch ${e}. Checking filesystem references...`);let f=this.options.filesystem?._fallbacks?.[l];if(f)console.warn(`Got fallback reference (module only) for ${e}.`),i=f,Object.defineProperty(info,"fallback",{value:!0,enumerable:!1});else{let h="was not resolved locally. You can provide a direct reference to use in";throw a.message.includes(h)?a:I(e,l)}}}await this.encoded,this.status="success",this.notify(this),s(i)}catch(a){this.status="failed",this.notify(null,a),n(a)}}),this.result);sources=async()=>await G(this.#t,this.#e,this.info.text.original)};var Xe=u,Ze=g,et=U,Ue=async(t,e={})=>{e=Object.assign({},e);let s=D(t,e);return await s.resolve(),s.result},tt=Ue;typeof globalThis.esm<"u"?Object.assign(globalThis.esm,N):globalThis.esm=N;})();
//# sourceMappingURL=index.js.map
